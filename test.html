<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OGH Farm - SDekza RO</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f8fafc; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        input, button, select, textarea { outline: none; }
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .safe-area-pb { padding-bottom: env(safe-area-inset-bottom, 20px); }

        /* YouTube Card */
        .yt-card { display: inline-flex; align-items: center; background: #1e293b; border: 1px solid #334155; border-radius: 50px; padding: 4px 4px 4px 12px; gap: 10px; text-decoration: none; transition: all 0.2s; }
        .yt-card:hover { transform: translateY(-2px); border-color: #475569; background: #334155; }
        .yt-avatar { width: 28px; height: 28px; border-radius: 50%; background-image: url('https://yt3.googleusercontent.com/vlD4rkRPBg-HIUX6kAbuW1AHgE1FzYa4cs7W3ZD1AV0z4Xg_vM42d1r_slf8SVPhjmJXPslvcg=s160-c-k-c0x00ffffff-no-rj'); background-size: cover; border: 1px solid #475569; }
        .yt-btn { background: #dc2626; color: white; padding: 4px 12px; border-radius: 20px; font-weight: bold; font-size: 10px; display: flex; align-items: center; gap: 4px; }
        .yt-btn:hover { background: #ef4444; }

        .btn-google { background-color: #1e293b; color: #f8fafc; border: 1px solid #334155; display: flex; align-items: center; justify-content: center; gap: 12px; padding: 14px 24px; border-radius: 16px; font-weight: 700; font-size: 14px; transition: all 0.2s; cursor: pointer; width: 100%; max-width: 320px; }
        .btn-google:hover { background-color: #334155; transform: translateY(-2px); border-color: #475569; }
        .btn-guest { background-color: transparent; color: #64748b; border: 1px solid #334155; display: flex; align-items: center; justify-content: center; gap: 8px; padding: 8px 16px; border-radius: 12px; font-weight: 600; font-size: 11px; transition: all 0.2s; cursor: pointer; width: auto; margin: 0 auto; max-width: 200px; }
        .btn-guest:hover { background-color: #1e293b; color: white; border-color: #475569; }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Firebase SDKs -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
      import { getFirestore, doc, setDoc, getDoc, collection, query, onSnapshot, addDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
      window.FirebaseSDK = { initializeApp, getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut, getFirestore, doc, setDoc, getDoc, collection, query, onSnapshot, addDoc, updateDoc, deleteDoc };
    </script>

    <script type="text/babel">
        // Config
        const OWNER_CONFIG = { apiKey: "AIzaSyAbWzr8o_OhkjGbEetBYq_nzYmVZ2fTf40", authDomain: "rocogh-88a38.firebaseapp.com", projectId: "rocogh-88a38", storageBucket: "rocogh-88a38.firebasestorage.app", messagingSenderId: "1025971309206", appId: "1:1025971309206:web:d4f9e0ab6bb016dde590b7", measurementId: "G-04JN1ERQ4T" };

        const { useState, useEffect, useMemo, useRef } = React;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } = window.Recharts || {};

        // --- Icons & SVGs ---
        const Icon = ({ name, size = 16, className = "" }) => {
            const ref = useRef(null);
            useEffect(() => {
                if (window.lucide && ref.current) {
                    ref.current.innerHTML = '';
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.setAttribute('class', className);
                    ref.current.appendChild(i);
                    window.lucide.createIcons({ root: ref.current, nameAttr: 'data-lucide', attrs: { width: size, height: size } });
                }
            }, [name, size, className]);
            return <span ref={ref} style={{ display: 'inline-flex', verticalAlign: 'middle' }}></span>;
        };

        const SVGs = {
            Zeny: () => <svg viewBox="0 0 32 32" className="w-4 h-4"><rect x="10" y="4" width="12" height="24" fill="#FFD700" rx="4" /><rect x="8" y="6" width="16" height="20" fill="#FFD700" /><rect x="10" y="6" width="12" height="20" fill="#FFEC8B" /><path d="M12 4 L20 4 L22 6 L22 26 L20 28 L12 28 L10 26 L10 6 Z" fill="none" stroke="#B8860B" strokeWidth="2" /><path d="M14 10 L20 10 L20 12 L16 18 L20 18 L20 20 L12 20 L12 18 L16 12 L12 12 Z" fill="#8B4513" /></svg>,
            Gum: () => <svg viewBox="0 0 32 32" className="w-4 h-4"><rect x="6" y="14" width="20" height="8" fill="#42A5F5" /><rect x="4" y="16" width="2" height="4" fill="#1E88E5" /><rect x="26" y="16" width="2" height="4" fill="#1E88E5" /><circle cx="16" cy="12" r="6" fill="#F06292" /><circle cx="14" cy="10" r="2" fill="#F48FB1" /><rect x="8" y="15" width="16" height="1" fill="#90CAF9" opacity="0.5" /></svg>,
            Spell: () => <svg viewBox="0 0 32 32" className="w-4 h-4"><path d="M16 4 L24 12 L24 22 L16 28 L8 22 L8 12 Z" fill="#7E57C2" /><path d="M16 6 L22 12 L22 20 L16 26 L10 20 L10 12 Z" fill="#9575CD" /><path d="M16 4 L16 28" stroke="#D1C4E9" strokeWidth="1" opacity="0.4" /><rect x="13" y="10" width="2" height="2" fill="#EDE7F6" /><rect x="18" y="18" width="1" height="1" fill="#EDE7F6" /></svg>,
            Magic: () => <svg viewBox="0 0 32 32" className="w-4 h-4"><circle cx="16" cy="16" r="10" fill="#EF5350" /><circle cx="16" cy="16" r="6" fill="#B71C1C" /><path d="M16 6 L18 10 L22 10 L20 14 L22 18 L18 18 L16 22 L14 18 L10 18 L12 14 L10 10 L14 10 Z" fill="#FFCDD2" opacity="0.5"/></svg>,
            Silvervine: () => <svg viewBox="0 0 32 32" className="w-3 h-3"><rect x="8" y="10" width="16" height="14" fill="#5D4037" /><rect x="14" y="4" width="4" height="6" fill="#4CAF50" /><rect x="14" y="14" width="4" height="4" fill="#FFD600" /><rect x="8" y="10" width="16" height="2" fill="#795548" /></svg>,
            Google: () => <svg width="20" height="20" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>
        };

        // --- COMPONENTS ---
        const WelcomeScreen = ({ onLogin, onGuest }) => (
            <div className="min-h-screen flex flex-col items-center justify-center bg-slate-950 p-6 text-center animate-fade-in">
                <div className="mb-8 w-24 h-24 bg-slate-800 rounded-3xl flex items-center justify-center shadow-xl border border-slate-700">
                    <SVGs.Spell className="w-12 h-12" />
                </div>
                <h1 className="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-500 mb-4">OGH Farming</h1>
                <p className="text-slate-400 text-sm mb-12">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£<br/>Ragnarok Online Classic / GGT</p>
                <div className="space-y-4 w-full max-w-xs">
                    <button onClick={onLogin} className="btn-google"><SVGs.Google /> Login with Gmail</button>
                    <button onClick={onGuest} className="btn-guest"><Icon name="user" size={14} /> <span>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Guest</span></button>
                </div>
                <div className="mt-12 opacity-50 hover:opacity-100 transition-opacity">
                    <a href="https://www.youtube.com/@SDekza-RO" target="_blank" className="yt-card"><div className="yt-avatar"></div><div className="flex flex-col text-left"><span className="text-[10px] font-bold text-white">SDekza RO</span><span className="text-[8px] text-slate-400">140+ Subs</span></div><div className="yt-btn"><Icon name="youtube" size={10}/> Subscribe</div></a>
                </div>
            </div>
        );

        const App = () => {
            // Helpers
            const formatZeny = (n) => new Intl.NumberFormat('th-TH').format(Math.round(n||0));
            const formatMZeny = (n) => (Number(n||0)/1000000).toFixed(2)+" M";
            const formatTimer = (ms) => {
                const m = Math.floor(ms/60000).toString().padStart(2,'0');
                const s = Math.floor((ms%60000)/1000).toString().padStart(2,'0');
                const c = Math.floor((ms%1000)/10).toString().padStart(2,'0');
                return `${m}:${s}:${c}`;
            };
            const convertToISO = (d) => { if(!d)return""; const p=d.split('/'); return p.length===3?`${p[2]}-${p[1]}-${p[0]}`:d; };
            const convertToDisplay = (d) => { if(!d) return ""; const p = d.split('-'); return p.length===3 ? `${p[2]}/${p[1]}/${p[0]}` : d; };

            const [records, setRecords] = useState(() => JSON.parse(localStorage.getItem('ogh_records')) || []);
            const [globalPrices, setGlobalPrices] = useState(() => JSON.parse(localStorage.getItem('ogh_prices')) || { purpleStonePrice:0, contMagicPrice:0, gumBoxPrice:0, silvervineBoxPrice:0 });
            
            const [activeTab, setActiveTab] = useState('ogh');
            const [isAdding, setIsAdding] = useState(false);
            const [showManual, setShowManual] = useState(false);
            const [showConfigModal, setShowConfigModal] = useState(false);
            const [configInput, setConfigInput] = useState("");
            const [editingId, setEditingId] = useState(null);
            const [chartMode, setChartMode] = useState('profit');
            const [gumFilter, setGumFilter] = useState('all');
            const [sortOrder, setSortOrder] = useState('date-desc');
            const [expandedId, setExpandedId] = useState(null);
            const [timeInMs, setTimeInMs] = useState(0);
            const [isTimerActive, setIsTimerActive] = useState(false);
            const [isTimerPaused, setIsTimerPaused] = useState(true);
            const [isGuestMode, setIsGuestMode] = useState(false);
            const timerRef = useRef(null);
            const [formData, setFormData] = useState({ date: new Date().toLocaleDateString('en-GB'), gumUsed: 0, trashAmount: "", purpleStoneCount: "", contMagicCount: "", isSellingSpell: false, isSellingMagic: false, useSilvervine: true, minutesUsed: 60, notes: "", otherCosts: [] });
            
            const firebaseAppRef = useRef(null); const authRef = useRef(null); const dbRef = useRef(null); const [user, setUser] = useState(null); const [isLoading, setIsLoading] = useState(true);

            // Firebase Init
            useEffect(() => {
                const init = async () => {
                    if (window.FirebaseSDK) {
                        try {
                            const { initializeApp, getAuth, getFirestore, onAuthStateChanged } = window.FirebaseSDK;
                            const app = initializeApp(OWNER_CONFIG);
                            window.auth = getAuth(app);
                            window.db = getFirestore(app);
                            onAuthStateChanged(window.auth, (u) => {
                                setUser(u);
                                setIsLoading(false);
                                if(u) syncData(u.uid);
                            });
                        } catch(e) { 
                            console.log("Firebase Error", e); 
                            setIsLoading(false);
                        }
                    } else { setIsLoading(false); }
                };
                setTimeout(init, 500); 
            }, []);

            const syncData = (uid) => {
                if (!window.FirebaseSDK || !window.db) return;
                const { collection, query, onSnapshot, doc, getDoc } = window.FirebaseSDK;
                const q = query(collection(window.db, 'artifacts', 'ro-farm-app', 'users', uid, 'farm_records'));
                onSnapshot(q, (snap) => setRecords(snap.docs.map(d => ({id:d.id, ...d.data()}))));
                getDoc(doc(window.db, 'artifacts', 'ro-farm-app', 'users', uid, 'settings', 'prices')).then(s => { if(s.exists()) setGlobalPrices(s.data()); });
            };

            // Persistence
            useEffect(() => { if(!user) localStorage.setItem('ogh_records', JSON.stringify(records)); }, [records, user]);
            useEffect(() => { if(!user) localStorage.setItem('ogh_prices', JSON.stringify(globalPrices)); }, [globalPrices, user]);
            
            // Timer
            useEffect(() => {
                if(isTimerActive && !isTimerPaused) {
                    timerRef.current = setInterval(() => setTimeInMs(p => p+10), 10);
                } else {
                    clearInterval(timerRef.current);
                }
                return () => clearInterval(timerRef.current);
            }, [isTimerActive, isTimerPaused]);
            
            // Handlers
            const handleTimerStart = () => { setIsTimerActive(true); setIsTimerPaused(false); };
            const handleTimerPause = () => { setIsTimerPaused(true); };
            const handleTimerStop = () => { const m = Math.ceil(timeInMs/60000); setFormData(p => ({...p, minutesUsed: m>0?m:1})); setIsTimerActive(false); setIsTimerPaused(true); };
            const handleTimerReset = () => { setTimeInMs(0); setIsTimerActive(false); setIsTimerPaused(true); };
            
            const handleLogin = async () => { if(!window.auth){setShowConfigModal(true);return;} try{ await window.FirebaseSDK.signInWithPopup(window.auth, new window.FirebaseSDK.GoogleAuthProvider()); }catch(e){ if(e.code==='auth/unauthorized-domain') alert(`Please add domain: ${window.location.hostname} to Firebase Console`); } };
            const handleLogout = () => { if(window.auth) { window.FirebaseSDK.signOut(window.auth); setUser(null); setIsGuestMode(false); setRecords([]); setGlobalPrices({ purpleStonePrice: 0, contMagicPrice: 0, gumBoxPrice: 0, silvervineBoxPrice: 0 }); window.location.reload(); } };
            const handleGuestLogin = () => { setIsGuestMode(true); };
            const handleExitGuest = () => { setIsGuestMode(false); setUser(null); setRecords([]); window.location.reload(); };
            const saveConfig = () => { try { JSON.parse(configInput); localStorage.setItem('firebase_config_json', configInput); window.location.reload(); } catch(e){ alert("Invalid JSON"); }};
            const updatePricesInCloud = async (np) => { if(user && window.db) await window.FirebaseSDK.setDoc(window.FirebaseSDK.doc(window.db, 'artifacts', 'ro-farm-app', 'users', user.uid, 'settings', 'prices'), np); };
            
            const addOtherCostField = () => setFormData(p => ({...p, otherCosts:[...p.otherCosts, {name:"", amount:""}]}));
            const removeOtherCostField = (i) => setFormData(p => ({...p, otherCosts:p.otherCosts.filter((_,x)=>x!==i)}));
            const updateOtherCost = (i, f, v) => { const n = [...formData.otherCosts]; n[i][f] = v; setFormData(p => ({...p, otherCosts:n})); };

            const handleSave = async (e) => {
                e.preventDefault();
                const p = { ...globalPrices }; // Snapshot prices
                const d = { 
                    ...formData, 
                    id: editingId || Date.now(), 
                    timestamp: Date.now(), 
                    mode: activeTab,
                    prices: p,
                    revenue: Number(formData.trashAmount||0) + (formData.isSellingSpell?(Number(formData.purpleStoneCount||0)*p.purpleStonePrice):0) + (activeTab==='aogh' && formData.isSellingMagic ? (Number(formData.contMagicCount||0)*p.contMagicPrice) : 0),
                    totalCost: (formData.gumUsed*(p.gumBoxPrice/10)) + (formData.useSilvervine ? (2*(p.silvervineBoxPrice/10)) : 0) + formData.otherCosts.reduce((a,b)=>a+Number(b.amount||0),0)
                };
                d.profit = d.revenue - d.totalCost;
                d.revenuePerMinute = d.minutesUsed > 0 ? d.revenue / d.minutesUsed : 0;

                if (user && window.db && !isGuestMode) {
                    const { doc, setDoc } = window.FirebaseSDK;
                    await setDoc(doc(window.db, 'artifacts', 'ro-farm-app', 'users', user.uid, 'farm_records', String(d.id)), d);
                } else {
                    setRecords(prev => editingId ? prev.map(r => r.id === editingId ? d : r) : [d, ...prev]);
                }
                setIsAdding(false); setEditingId(null);
                setFormData({ date: new Date().toLocaleDateString('en-GB'), gumUsed: 0, trashAmount: "", purpleStoneCount: "", contMagicCount: "", isSellingSpell: false, isSellingMagic: false, useSilvervine: true, minutesUsed: 60, notes: "", otherCosts: [] });
            };

            const handleDelete = async (id) => {
                if (user && window.db && !isGuestMode) {
                    await window.FirebaseSDK.deleteDoc(window.FirebaseSDK.doc(window.db, 'artifacts', 'ro-farm-app', 'users', user.uid, 'farm_records', String(id)));
                } else {
                    setRecords(prev => prev.filter(r => r.id !== id));
                }
            };

            const startEdit = (r) => {
                setFormData({ 
                    ...r, 
                    // Ensure defaults for older records
                    contMagicCount: r.contMagicCount || "",
                    isSellingMagic: r.isSellingMagic || false,
                    useSilvervine: r.useSilvervine !== false
                });
                setEditingId(r.id); setIsAdding(true);
            };

            // Stats Calc
            const filteredRecords = records.filter(r => (r.mode || 'ogh') === activeTab);
            const processedData = filteredRecords.map(r => {
                const p = r.prices || globalPrices;
                const rev = Number(r.trashAmount||0) + (r.isSellingSpell?(Number(r.purpleStoneCount||0)*p.purpleStonePrice):0) + ((r.mode==='aogh'&&r.isSellingMagic)?(Number(r.contMagicCount||0)*p.contMagicPrice):0);
                
                // Silvervine Calc
                let svCost = 0;
                if(r.useSilvervine !== false) {
                    const runsThatDay = records.filter(rec => rec.date === r.date && rec.useSilvervine !== false).length;
                    svCost = (2 * (p.silvervineBoxPrice / 10)) / (runsThatDay || 1);
                }
                const gumCost = r.gumUsed*(p.gumBoxPrice/10);
                const totalCost = gumCost + svCost + (r.otherCosts||[]).reduce((a,b)=>a+Number(b.amount||0),0);

                return { ...r, revenue:rev, totalCost, profit:rev-totalCost, gumCost, silvervineCost:svCost };
            }).sort((a,b) => {
                const [d1,m1,y1] = a.date.split('/'); const [d2,m2,y2] = b.date.split('/');
                return (new Date(y2,m2-1,d2) - new Date(y1,m1-1,d1)) || (b.timestamp - a.timestamp);
            });

            const stats = useMemo(() => ({
                totalProfit: processedData.reduce((a,b)=>a+b.profit,0),
                avgRevenue: processedData.length ? processedData.reduce((a,b)=>a+b.revenue,0)/processedData.length : 0,
                maxRevenue: Math.max(0, ...processedData.map(r=>r.revenue)),
                minRevenue: processedData.length ? Math.min(...processedData.map(r=>r.revenue)) : 0,
                avgRevenuePerMinute: processedData.length ? processedData.reduce((a,b)=>a+(b.minutesUsed>0?b.revenue/b.minutesUsed:0),0)/processedData.length : 0,
                totalStoredStones: processedData.reduce((a,b)=>a+(!b.isSellingSpell?Number(b.purpleStoneCount||0):0),0),
                totalStoredMagic: processedData.reduce((a,b)=>a+(!b.isSellingMagic?Number(b.contMagicCount||0):0),0)
            }), [processedData]);

            const chartData = processedData.map(r => ({ ...r, purpleStoneCount: Number(r.purpleStoneCount||0), contMagicCount: Number(r.contMagicCount||0) })).reverse();

            if (isLoading) return <div className="min-h-screen flex items-center justify-center bg-slate-950 text-white font-bold">LOADING...</div>;
            if (!user && !isGuestMode && records.length === 0 && !isAdding) return <WelcomeScreen onLogin={handleLogin} onGuest={()=>setIsGuestMode(true)} />;

            return (
                <div className="min-h-screen p-4 md:p-6 lg:p-8 pb-32 max-w-5xl mx-auto safe-area-pb">
                    {/* ... Config Modal ... */}
                    {showConfigModal && (<div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in"><div className="bg-slate-900 border border-slate-800 w-full max-w-lg p-8 rounded-[2rem] shadow-2xl relative"><button onClick={()=>setShowConfigModal(false)} className="absolute top-6 right-6 text-slate-500 hover:text-white"><Icon name="x"/></button><h3 className="text-xl font-black mb-4 text-purple-400">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase</h3><textarea className="w-full h-40 bg-slate-950 border border-slate-700 rounded-xl p-4 text-xs font-mono text-green-400 outline-none mb-4" value={configInput} onChange={e=>setConfigInput(e.target.value)} placeholder='{ "apiKey": "..." }'></textarea><button onClick={saveConfig} className="w-full bg-blue-600 hover:bg-blue-500 py-3 rounded-xl font-bold uppercase text-xs">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div></div>)}
                    {showManual && (<div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in" onClick={()=>setShowManual(false)}><div className="bg-slate-900 border border-slate-800 w-full max-w-md p-8 rounded-[2rem] shadow-2xl relative" onClick={e=>e.stopPropagation()}><button onClick={()=>setShowManual(false)} className="absolute top-6 right-6 text-slate-500 hover:text-white"><Icon name="x"/></button><h3 className="text-xl font-black mb-6 text-purple-400 italic">üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</h3><div className="space-y-4 text-sm text-slate-300"><p>1. <b>iOS:</b> Safari > ‡πÅ‡∏ä‡∏£‡πå > Add to Home Screen</p><p>2. <b>Android:</b> Chrome > ‡πÄ‡∏°‡∏ô‡∏π > Install App</p></div><button onClick={()=>setShowManual(false)} className="w-full mt-8 bg-slate-800 py-3 rounded-xl font-bold uppercase text-xs">‡∏ï‡∏Å‡∏•‡∏á</button></div></div>)}

                    {/* Header */}
                    <div className="flex justify-between items-center mb-6">
                        <div>
                            <h1 className="text-2xl font-black bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent italic">Old Glast Heim</h1>
                            <p className="text-xs text-slate-500 font-bold tracking-widest">{user ? 'CLOUD MODE' : 'OFFLINE MODE'}</p>
                        </div>
                        <div className="flex gap-2">
                             {user && <button onClick={() => window.FirebaseSDK.signOut(window.auth).then(()=>{setUser(null); setIsGuestMode(false);})} className="text-[10px] text-red-400 border border-red-500/30 px-3 py-1 rounded-lg hover:bg-red-500/10">LOGOUT</button>}
                             {isGuestMode && <button onClick={() => {setIsGuestMode(false); setRecords([]);}} className="text-[10px] text-slate-400 border border-slate-600 px-3 py-1 rounded-lg hover:bg-slate-800">EXIT</button>}
                             <button onClick={() => setIsAdding(!isAdding)} className="bg-purple-600 text-white px-4 py-2 rounded-xl text-xs font-bold shadow-lg flex items-center gap-2"><Icon name={isAdding ? "layout-dashboard" : "plus-circle"} /> {isAdding ? "‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å" : "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å"}</button>
                        </div>
                    </div>

                    {/* Tabs */}
                    <div className="flex justify-center mb-6">
                        <div className="bg-slate-900/80 p-1 rounded-xl border border-slate-800 flex gap-1">
                            <button onClick={()=>setActiveTab('ogh')} className={`px-6 py-2 rounded-lg text-xs font-bold transition-all ${activeTab==='ogh'?'bg-purple-600 text-white shadow':'text-slate-500 hover:text-white'}`}>OGH (Normal)</button>
                            <button onClick={()=>setActiveTab('aogh')} className={`px-6 py-2 rounded-lg text-xs font-bold transition-all ${activeTab==='aogh'?'bg-red-600 text-white shadow':'text-slate-500 hover:text-white'}`}>AOGH (Hard)</button>
                        </div>
                    </div>

                    {/* MAIN CONTENT */}
                    {!isAdding ? (
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 animate-fade-in">
                            {/* Stat Cards */}
                            <div className="bg-slate-900 border border-slate-800 p-5 rounded-3xl relative overflow-hidden">
                                <div className="absolute top-0 right-0 p-3 opacity-10"><Icon name="wallet" size={64}/></div>
                                <h3 className="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1">‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h3>
                                <p className="text-2xl font-black text-white">{formatMZeny(stats.totalProfit)} <span className="text-xs text-slate-600">Z</span></p>
                            </div>
                            <div className="bg-slate-900 border border-slate-800 p-5 rounded-3xl">
                                <h3 className="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
                                <p className="text-2xl font-black text-white">{formatMZeny(stats.avgRevenue)} <span className="text-xs text-slate-600">Z</span></p>
                                <div className="flex items-center gap-2 mt-2 text-[10px] font-bold">
                                    <span className="text-blue-400 bg-blue-500/10 px-2 py-0.5 rounded flex items-center gap-1"><Icon name="clock" size={10} /> {formatZeny(stats.avgRevenuePerMinute)}/m</span>
                                </div>
                            </div>
                            <div className="bg-slate-900 border border-slate-800 p-5 rounded-3xl">
                                <h3 className="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏•‡∏±‡∏á ({activeTab.toUpperCase()})</h3>
                                <div className="flex items-baseline gap-2">
                                    <p className="text-2xl font-black text-amber-400">{formatMZeny((stats.totalStoredStones * globalPrices.purpleStonePrice) + (stats.totalStoredMagic * globalPrices.contMagicPrice))}</p>
                                    <span className="text-[10px] text-slate-500 font-bold">Zeny</span>
                                </div>
                                <div className="mt-2 space-y-1">
                                    <p className="text-[10px] text-slate-400 flex justify-between"><span>Spell:</span> <span className="text-white">{stats.totalStoredStones} ea</span></p>
                                    {activeTab === 'aogh' && <p className="text-[10px] text-slate-400 flex justify-between"><span>Magic:</span> <span className="text-white">{stats.totalStoredMagic} ea</span></p>}
                                </div>
                            </div>

                            {/* Chart Area */}
                            <div className="md:col-span-2 bg-slate-900 border border-slate-800 p-6 rounded-3xl h-64">
                                <ResponsiveContainer width="100%" height="100%">
                                    <LineChart data={chartData}>
                                        <CartesianGrid strokeDasharray="3 3" stroke="#1e293b" vertical={false} />
                                        <XAxis dataKey="date" stroke="#475569" fontSize={10} tickLine={false} axisLine={false} />
                                        <YAxis stroke="#475569" fontSize={10} tickFormatter={v => `${v/1000}k`} tickLine={false} axisLine={false} />
                                        <Tooltip contentStyle={{backgroundColor:'#0f172a', border:'none', borderRadius:'8px'}} itemStyle={{fontSize:'12px'}} formatter={(v)=>[formatZeny(v), "Profit"]} />
                                        <Line type="monotone" dataKey="profit" stroke="#a855f7" strokeWidth={3} dot={false} />
                                    </LineChart>
                                </ResponsiveContainer>
                            </div>

                            {/* Sidebar Group */}
                            <div className="space-y-4">
                                {/* Price Card */}
                                <div className={`bg-slate-900 border p-5 rounded-3xl relative ${!records.length && Object.values(globalPrices).every(v=>v===0) ? 'border-rose-500 shadow-[0_0_15px_rgba(244,63,94,0.3)]' : 'border-slate-800'}`}>
                                    {!records.length && Object.values(globalPrices).every(v=>v===0) && <span className="absolute -top-2 -right-2 bg-rose-500 text-white text-[10px] font-bold px-2 py-1 rounded-lg shadow animate-bounce">! ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</span>}
                                    <h4 className="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏•‡∏≤‡∏î (Market Price)</h4>
                                    <div className="space-y-3">
                                        {[
                                            {k:'purpleStonePrice', l:'Coagulated Spell', i:<SVGs.Spell/>},
                                            ...(activeTab==='aogh' ? [{k:'contMagicPrice', l:'Contaminated Magic', i:<SVGs.Magic/>}] : []),
                                            {k:'gumBoxPrice', l:'Gum Box', i:<SVGs.Gum/>},
                                            {k:'silvervineBoxPrice', l:'Silvervine Box', i:<SVGs.Silvervine/>}
                                        ].map(o => (
                                            <div key={o.k} className="flex justify-between items-center">
                                                <span className="flex items-center gap-2 text-[10px] text-slate-400">{o.i} {o.l}</span>
                                                <input type="number" className={`bg-transparent text-right text-xs font-bold w-20 outline-none ${!globalPrices[o.k] ? 'text-rose-400 placeholder-rose-500/50' : 'text-white'}`} placeholder="0" value={globalPrices[o.k] || ''} onChange={e => { const v=Number(e.target.value); setGlobalPrices(p => { const n={...p, [o.k]:v}; if(user && window.db) window.FirebaseSDK.setDoc(window.FirebaseSDK.doc(window.db, 'artifacts', 'ro-farm-app', 'users', user.uid, 'settings', 'prices'), n); return n; }); }} />
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Timer Card (Compact) */}
                                <div className="bg-slate-900 border border-slate-800 p-4 rounded-3xl">
                                    <div className="flex justify-between items-center mb-2">
                                        <h4 className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Timer</h4>
                                        <span className="text-xl font-black text-white tabular-nums">{formatTimer(timeInMs)}</span>
                                    </div>
                                    <div className="grid grid-cols-3 gap-2">
                                        <button onClick={() => { setIsTimerActive(!isTimerActive); setIsTimerPaused(false); }} className={`col-span-2 rounded-lg text-[10px] font-bold py-3 ${isTimerActive ? 'bg-amber-500 text-white' : 'bg-green-600 text-white'}`}>{isTimerActive ? 'PAUSE' : 'START'}</button>
                                        <button onClick={() => { setTimeInMs(0); setIsTimerActive(false); }} className="bg-slate-800 text-slate-400 hover:text-white rounded-lg text-[10px] font-bold py-3">RESET</button>
                                    </div>
                                </div>
                            </div>
                            
                            {/* History Table */}
                            <div className="md:col-span-3 bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden mt-4">
                                <div className="p-6 border-b border-slate-800 flex justify-between items-center">
                                    <h3 className="text-sm font-black text-white flex items-center gap-2"><Icon name="history"/> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°</h3>
                                </div>
                                <div className="overflow-x-auto">
                                    <table className="w-full text-left text-xs">
                                        <thead className="bg-slate-950/50 text-slate-500 font-bold uppercase tracking-wider">
                                            <tr>
                                                <th className="px-6 py-4">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                                <th className="px-6 py-4">‡πÑ‡∏≠‡πÄ‡∏ó‡∏°</th>
                                                <th className="px-6 py-4 text-right">‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th>
                                                <th className="px-6 py-4 text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-slate-800">
                                            {processedData.map(r => (
                                                <React.Fragment key={r.id}>
                                                    <tr className="hover:bg-slate-800/50 cursor-pointer transition-colors" onClick={() => setExpandedId(expandedId===r.id?null:r.id)}>
                                                        <td className="px-6 py-4 font-bold text-slate-300">{r.date}</td>
                                                        <td className="px-6 py-4">
                                                            <div className="flex gap-2">
                                                                <span className="bg-blue-500/10 text-blue-400 px-2 py-0.5 rounded border border-blue-500/20 font-bold">GUM {r.gumUsed}</span>
                                                                <span className={`bg-${r.isSellingSpell?'green':'amber'}-500/10 text-${r.isSellingSpell?'green':'amber'}-400 px-2 py-0.5 rounded border border-${r.isSellingSpell?'green':'amber'}-500/20 font-bold`}>{r.purpleStoneCount} Spell</span>
                                                                {r.mode==='aogh' && <span className={`bg-${r.isSellingMagic?'green':'red'}-500/10 text-${r.isSellingMagic?'green':'red'}-400 px-2 py-0.5 rounded border border-${r.isSellingMagic?'green':'red'}-500/20 font-bold`}>{r.contMagicCount} Magic</span>}
                                                            </div>
                                                        </td>
                                                        <td className={`px-6 py-4 text-right font-black ${r.profit>0?'text-green-400':'text-red-400'}`}>{formatZeny(r.profit)}</td>
                                                        <td className="px-6 py-4 text-center">
                                                            <button onClick={(e)=>{e.stopPropagation();startEdit(r)}} className="text-slate-500 hover:text-white mr-2"><Icon name="pencil" size={14}/></button>
                                                            <button onClick={(e)=>{e.stopPropagation();handleDelete(r.id)}} className="text-slate-500 hover:text-red-500"><Icon name="trash-2" size={14}/></button>
                                                        </td>
                                                    </tr>
                                                    {expandedId === r.id && (
                                                        <tr className="bg-slate-950/30">
                                                            <td colSpan="4" className="px-6 py-4">
                                                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-[10px] text-slate-400">
                                                                    <div><p className="font-bold text-slate-500 mb-1">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</p><p>Trash: {formatZeny(r.trashAmount)}</p><p>Total: <span className="text-green-400">{formatZeny(r.revenue)}</span></p></div>
                                                                    <div><p className="font-bold text-slate-500 mb-1">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</p><p>Gum: {formatZeny(r.gumCost)}</p><p>Silvervine: {formatZeny(r.silvervineCost)}</p><p>Total: <span className="text-red-400">{formatZeny(r.totalCost)}</span></p></div>
                                                                    <div><p className="font-bold text-slate-500 mb-1">‡πÄ‡∏ß‡∏•‡∏≤</p><p>{r.minutesUsed} ‡∏ô‡∏≤‡∏ó‡∏µ</p><p>Avg: {formatZeny(r.revenuePerMinute)}/m</p></div>
                                                                    <div><p className="font-bold text-slate-500 mb-1">Note</p><p className="italic">{r.notes || "-"}</p></div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    )}
                                                </React.Fragment>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    ) : (
                        // ADD FORM
                        <form onSubmit={handleSave} className="bg-slate-900 border border-slate-800 p-6 md:p-8 rounded-[2.5rem] shadow-xl max-w-2xl mx-auto animate-slide-up">
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-xl font-black text-white flex items-center gap-2"><Icon name={editingId?"pencil":"plus-circle"} className="text-purple-500"/> {editingId?"‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•":"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"}</h2>
                                <label className="flex items-center gap-2 cursor-pointer bg-slate-950 px-3 py-1.5 rounded-xl border border-slate-800 hover:border-slate-700 transition-all">
                                    <div className={`w-4 h-4 rounded border flex items-center justify-center transition-colors ${formData.useSilvervine?'bg-green-500 border-green-500':'border-slate-600'}`}>{formData.useSilvervine && <Icon name="check" size={10} className="text-white"/>}</div>
                                    <input type="checkbox" className="hidden" checked={formData.useSilvervine} onChange={e=>setFormData({...formData, useSilvervine:e.target.checked})}/>
                                    <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1">‡πÉ‡∏ä‡πâ Silvervine <SVGs.Silvervine/></span>
                                </label>
                            </div>

                            <div className="space-y-6">
                                {/* Row 1 */}
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><Icon name="calendar" size={12}/> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (DD/MM/YYYY)</label>
                                        <input type="text" className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm font-bold" value={formData.date} onChange={e=>setFormData({...formData, date:e.target.value})} required placeholder="DD/MM/YYYY" />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><SVGs.Gum/> Bubble Gum</label>
                                        <div className="flex bg-slate-950 p-1 rounded-xl border border-slate-800">
                                            {[0,1,2].map(n => <button type="button" key={n} onClick={()=>setFormData({...formData, gumUsed:n})} className={`flex-1 rounded-lg text-xs font-bold py-2 transition-all ${formData.gumUsed===n ? 'bg-blue-600 text-white shadow':'text-slate-500 hover:text-slate-300'}`}>{n}</button>)}
                                        </div>
                                    </div>
                                </div>

                                {/* Row 2 */}
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><Icon name="clock" size={12}/> ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                                        <input type="number" className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm font-bold" value={formData.minutesUsed} onChange={e=>setFormData({...formData, minutesUsed:Number(e.target.value)})} />
                                    </div>
                                    <div className="space-y-2">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ (Zeny)</label>
                                        <input type="number" className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm font-bold" value={formData.trashAmount} onChange={e=>setFormData({...formData, trashAmount:e.target.value})} placeholder="0" />
                                    </div>
                                </div>

                                {/* Row 3 */}
                                <div className="space-y-4 pt-4 border-t border-slate-800/50">
                                    <div className="grid grid-cols-2 gap-4">
                                        {/* Coagulated */}
                                        <div className="space-y-2">
                                            <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><SVGs.Spell/> Coagulated Spell</label>
                                            <div className="flex gap-2">
                                                <input type="number" className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm font-bold" value={formData.purpleStoneCount} onChange={e=>setFormData({...formData, purpleStoneCount:e.target.value})} placeholder="0" />
                                                <div className="flex bg-slate-950 p-1 rounded-xl border border-slate-800 shrink-0">
                                                    <button type="button" onClick={()=>setFormData({...formData, isSellingSpell:true})} className={`px-3 rounded-lg text-[10px] font-bold uppercase transition-all ${formData.isSellingSpell ? 'bg-rose-600 text-white shadow' : 'text-slate-500'}`}>Sell</button>
                                                    <button type="button" onClick={()=>setFormData({...formData, isSellingSpell:false})} className={`px-3 rounded-lg text-[10px] font-bold uppercase transition-all ${!formData.isSellingSpell ? 'bg-green-600 text-white shadow' : 'text-slate-500'}`}>Store</button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {/* Magic (AOGH only) */}
                                        {activeTab === 'aogh' && (
                                            <div className="space-y-2 animate-fade-in">
                                                <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><SVGs.Magic/> Contaminated Magic</label>
                                                <div className="flex gap-2">
                                                    <input type="number" className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm font-bold" value={formData.contMagicCount} onChange={e=>setFormData({...formData, contMagicCount:e.target.value})} placeholder="0" />
                                                    <div className="flex bg-slate-950 p-1 rounded-xl border border-slate-800 shrink-0">
                                                        <button type="button" onClick={()=>setFormData({...formData, isSellingMagic:true})} className={`px-3 rounded-lg text-[10px] font-bold uppercase transition-all ${formData.isSellingMagic ? 'bg-rose-600 text-white shadow' : 'text-slate-500'}`}>Sell</button>
                                                        <button type="button" onClick={()=>setFormData({...formData, isSellingMagic:false})} className={`px-3 rounded-lg text-[10px] font-bold uppercase transition-all ${!formData.isSellingMagic ? 'bg-green-600 text-white shadow' : 'text-slate-500'}`}>Store</button>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <div className="space-y-3 border-t border-slate-800 pt-6">
                                    <div className="flex justify-between items-center"><label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><Icon name="plus" size={12}/> ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label><button type="button" onClick={addOtherCostField} className="text-[9px] font-black px-3 py-1 rounded-lg border border-blue-500/30 bg-blue-500/10 text-blue-500 hover:bg-blue-500/20 transition-all">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button></div>
                                    {formData.otherCosts.map((cost, idx) => (
                                        <div key={idx} className="flex gap-3"><input type="text" value={cost.name} onChange={(e) => updateOtherCost(idx, 'name', e.target.value)} className="flex-[2] bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-xs font-bold outline-none" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£..." /><div className="flex-1 relative"><input type="number" value={cost.amount} onChange={(e) => updateOtherCost(idx, 'amount', e.target.value)} className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 pr-8 text-white text-xs font-bold outline-none text-right" /><span className="absolute right-3 top-1/2 -translate-y-1/2 text-[8px] font-black text-slate-600">Z</span></div><button type="button" onClick={() => removeOtherCostField(idx)} className="text-red-500 p-2 hover:bg-red-500/10 rounded-xl"><Icon name="minus-circle" size={18}/></button></div>
                                    ))}
                                </div>

                                <div className="space-y-2 pt-2">
                                    <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><Icon name="file-text" size={12}/> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                                    <textarea className="w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm" value={formData.notes} onChange={e=>setFormData({...formData, notes:e.target.value})} placeholder="..." />
                                </div>
                            </div>
                            
                            <div className="mt-8 pt-6 border-t border-slate-800 flex gap-4">
                                <button type="button" onClick={() => setIsAdding(false)} className="flex-1 bg-slate-800 hover:bg-slate-700 text-white py-4 rounded-xl font-bold transition-all">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                                <button type="submit" className="flex-[2] bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-4 rounded-xl font-bold shadow-lg transition-all transform active:scale-95">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                            </div>
                        </form>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
